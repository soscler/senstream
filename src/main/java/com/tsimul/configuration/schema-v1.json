{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "",
  "description": "This is the schema of the system configuration file",

  "definitions": {

    "sensor": {
      "$id": "#sensor",
      "type": "object",
      "allOf": [
        {
          "$ref": "#device"
        }
      ]
    },

    "actuator": {
      "$id": "#actuator",
      "type": "object",
      "allOf": [
        {
          "$ref": "#device"
        }
      ]
    },

    "device": {
      "type": "object",
      "$id": "#device",
      "allOf": [
        {
          "properties": {
            "metadata": {
              "$ref": "#metadata"
            },
            "generation": {
              "$ref": "#generation"
            },
            "transport": {
              "type": "string",
              "enum": ["HTTP", "WS", "KAFKA"]
            },
            "storage": {
              "type": "string",
              "enum": ["CASSANDRA", "MONGODB"]
            },
            "analytics": {
              "type": "string",
              "enum": ["BASIC", "ADVANCED", "EXPERT"]
            }
          }
        }
      ]
    },

    "metadata": {
      "type": "object",
      "$id": "#metadata",
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "version": {
          "type": "string"
        },
        "description": {
          "type": "string"
        }
      },
      "required": ["name"]
    },


    "plugin": {
      "$id": "#plugin",
      "allOf": [
        {
          "properties": {
            "type": {
              "type": "string",
              "enum": ["TRANSPORT", "ANALYTICS", "STORAGE", "OTHER"]
            },
            "metadata": {
              "$ref": "#metadata"
            },
            "event": {
              "type": "string",
              "enum": ["ON", "OFF", "UPDATE"]
            }
          }
        }
      ]
    },

    "generation": {
      "type": "object",
      "$id": "#generation",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["NUMERICAL", "BOOLEAN"]
        },
        "frequency": {
          "type": "number"
        }
      },
      "if": {
        "properties": {
          "type": {
            "const": "numerical"
          }
        }
      },
      "then": {
        "properties": {
          "min": {
            "type": "number"
          },
          "max": {
            "type": "number"
          }
        },
        "required": ["min", "max"]
      },
      "required": ["type", "frequency"]
    }
  },


  "type": "object",
  "properties": {
    "name": {
      "type": "string",
      "maxLength": 250
    },
    "senMLVersion": {
      "type:": "nonNegativeInteger",
      "maximum": 10
    },
    "sensors": {
      "type": "array",
      "items": {
        "$ref": "#sensor"
      },
      "uniqueItems": true
    },
    "actuators": {
      "type": "array",
      "items": {
        "$ref": "#actuator"
      },
      "uniqueItems": true
    }
  },

  "required": ["name", "senMLVersion"],
  "additionalProperties": false
}

